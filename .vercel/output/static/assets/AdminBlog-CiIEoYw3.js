import{c as p,u as z,s as h,j as e,m as L,X as _}from"./index-OS5PG3nP.js";import{r as l}from"./vendor-CyBwq7db.js";import{U as A}from"./user-C0MdHqYQ.js";import{C as T}from"./calendar-kBBxVc52.js";import{E as $}from"./eye-BW6Uh3t7.js";import"./router-seI_uwDy.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=p("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=p("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=p("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Z=()=>{const[b,v]=l.useState([]),[k,u]=l.useState(!1),[d,m]=l.useState(null),[C,y]=l.useState(!0),[j,w]=l.useState(!1),[x,r]=l.useState(""),[a,g]=l.useState({title:"",description:"",content:"",image:"",category:"",author:"S. Iniya"}),{user:i,logout:P}=z(),S=["Data Processing","Data Entry","Publication","Content Writing","Technology","Data Management"];l.useEffect(()=>{f()},[]);const f=async()=>{try{console.log("Fetching blog posts from Supabase...");const{data:t,error:s}=await h.from("blog_posts").select("*").order("created_at",{ascending:!1});if(s){console.error("Error fetching posts:",s),r(`Error fetching posts: ${s.message}`);return}console.log("Successfully fetched posts:",(t==null?void 0:t.length)||0),v(t||[])}catch(t){console.error("Error fetching posts:",t),r(`Error fetching posts: ${t}`)}finally{y(!1)}},c=t=>{g({...a,[t.target.name]:t.target.value})},E=t=>{const o=t.replace(/<[^>]*>/g,"").split(/\s+/).length;return`${Math.ceil(o/200)} min read`},D=async t=>{t.preventDefault(),w(!0),r("");try{const s={title:a.title,description:a.description,content:a.content,image:a.image,category:a.category,author:a.author,read_time:E(a.content)};if(console.log("Submitting post data:",s),d){console.log("Updating existing post with ID:",d.id);const{data:o,error:n}=await h.from("blog_posts").update({...s,updated_at:new Date().toISOString()}).eq("id",d.id).select();if(n)throw console.error("Update error:",n),n;console.log("Post updated successfully:",o),r("Post updated successfully!")}else{console.log("Creating new post");const{data:o,error:n}=await h.from("blog_posts").insert([s]).select();if(n)throw console.error("Insert error:",n),n;console.log("Post created successfully:",o),r("Post created successfully!")}await f(),g({title:"",description:"",content:"",image:"",category:"",author:"S. Iniya"}),u(!1),m(null),r("")}catch(s){console.error("Error saving post:",s);const o=s instanceof Error?s.message:String(s);r(`Error saving post: ${o}. Please try again.`)}finally{w(!1)}},M=t=>{m(t),g({title:t.title,description:t.description,content:t.content,image:t.image,category:t.category,author:t.author}),u(!0),r("")},I=async t=>{if(confirm("Are you sure you want to delete this post?"))try{y(!0),console.log("Deleting post with ID:",t);const{data:s,error:o}=await h.from("blog_posts").delete().eq("id",t).select();if(o)throw console.error("Delete error:",o),o;console.log("Post deleted successfully:",s),await f(),r("Post deleted successfully!"),setTimeout(()=>r(""),3e3)}catch(s){console.error("Error deleting post:",s);const o=s instanceof Error?s.message:String(s);r(`Error deleting post: ${o}. Please try again.`),setTimeout(()=>r(""),3e3)}finally{y(!1)}},q=()=>{m(null),g({title:"",description:"",content:"",image:"",category:"",author:(i==null?void 0:i.username)||"S. Iniya"}),u(!0),r("")},N=()=>{u(!1),m(null),r("")};return C?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"container mx-auto page-container",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Blog Administration"}),e.jsxs("p",{className:"text-gray-600",children:["Welcome, ",i==null?void 0:i.username,"! Manage your blog posts and content"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:q,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold flex items-center space-x-2 transition-colors",children:[e.jsx(F,{size:20}),e.jsx("span",{children:"Create New Post"})]}),e.jsxs("button",{onClick:P,className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg font-semibold flex items-center space-x-2 transition-colors",children:[e.jsx(U,{size:20}),e.jsx("span",{children:"Logout"})]})]})]})}),x&&e.jsx("div",{className:`mb-6 p-4 rounded-lg ${x.includes("Error")||x.includes("error")?"bg-red-100 border border-red-400 text-red-700":"bg-green-100 border border-green-400 text-green-700"}`,children:x}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(L.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-lg p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:d?"Edit Post":"Create New Post"}),e.jsx("button",{onClick:N,className:"text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(_,{size:24})})]}),e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),e.jsx("input",{type:"text",name:"title",value:a.title,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),e.jsxs("select",{name:"category",value:a.category,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select Category"}),S.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Author *"}),e.jsx("input",{type:"text",name:"author",value:a.author,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image URL *"}),e.jsx("input",{type:"url",name:"image",value:a.image,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{name:"description",value:a.description,onChange:c,required:!0,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the blog post..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content *"}),e.jsx("textarea",{name:"content",value:a.content,onChange:c,required:!0,rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Write your blog content here. You can use HTML tags for formatting..."})]}),e.jsxs("div",{className:"flex space-x-4 pt-4",children:[e.jsx("button",{type:"submit",disabled:j,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-semibold transition-colors disabled:opacity-50",children:j?"Saving...":d?"Update Post":"Create Post"}),e.jsx("button",{type:"button",onClick:N,className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors",children:"Cancel"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["All Posts (",b.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Post"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Author"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-12 h-12 object-cover rounded-lg mr-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 max-w-xs truncate",children:t.title}),e.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:t.description})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:t.category})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{size:16,className:"mr-1"}),t.author]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{size:16,className:"mr-1"}),new Date(t.created_at).toLocaleDateString()]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>window.open(`/blog/${t.id}`,"_blank"),className:"text-green-600 hover:text-green-900 transition-colors",title:"View Post",children:e.jsx($,{size:18})}),e.jsx("button",{onClick:()=>M(t),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Edit Post",children:e.jsx(H,{size:18})}),e.jsx("button",{onClick:()=>I(t.id),className:"text-red-600 hover:text-red-900 transition-colors",title:"Delete Post",children:e.jsx(V,{size:18})})]})})]},t.id))})]})})]})]})})};export{Z as default};
